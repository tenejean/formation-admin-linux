<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jour 22 - LVM et RAID | Formation Admin Syst√®me Linux</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
        }
        
        .content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        .section h2 {
            color: #2c3e50;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            position: relative;
        }
        
        .section h2::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 50px;
            height: 3px;
            background: #764ba2;
        }
        
        .section h3 {
            color: #34495e;
            font-size: 1.5em;
            margin: 25px 0 15px 0;
            padding-left: 20px;
            border-left: 4px solid #667eea;
        }
        
        .section h4 {
            color: #2c3e50;
            font-size: 1.2em;
            margin: 20px 0 10px 0;
            font-weight: 600;
        }
        
        .definition {
            background: linear-gradient(135deg, #667eea20, #764ba20);
            border-left: 5px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .definition strong {
            color: #2c3e50;
            font-size: 1.1em;
        }
        
        .command-box {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .command-box .prompt {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .warning {
            background: linear-gradient(135deg, #ff7f5020, #ff6b3520);
            border-left: 5px solid #e74c3c;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .info {
            background: linear-gradient(135deg, #3498db20, #2980b920);
            border-left: 5px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .comparison-table tr:hover {
            background: #f8f9fa;
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }
        
        .toc {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .toc h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            border: none;
            padding: 0;
        }
        
        .toc ul {
            list-style: none;
        }
        
        .toc li {
            margin: 8px 0;
        }
        
        .toc a {
            color: #667eea;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        .toc a:hover {
            background: #667eea;
            color: white;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîß Jour 22 - LVM et RAID</h1>
            <p>Formation Administration Syst√®me Linux | Responsable: Jean Tene</p>
        </div>
        
        <div class="content">
            <div class="toc">
                <h3>üìö Table des mati√®res</h3>
                <ul>
                    <li><a href="#introduction">1. Introduction</a></li>
                    <li><a href="#lvm">2. LVM (Logical Volume Manager)</a></li>
                    <li><a href="#raid">3. RAID (Redundant Array of Independent Disks)</a></li>
                    <li><a href="#lvm-raid">4. Combinaison LVM et RAID</a></li>
                    <li><a href="#tp">5. Travaux Pratiques</a></li>
                    <li><a href="#conclusion">6. Conclusion et Ressources</a></li>
                </ul>
            </div>

            <div class="section" id="introduction">
                <h2>üéØ 1. Introduction</h2>
                
                <div class="definition">
                    <strong>Objectifs du cours :</strong><br>
                    √Ä l'issue de cette formation, vous serez capable de :
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>Comprendre les concepts de LVM et RAID</li>
                        <li>Configurer et g√©rer des volumes logiques LVM</li>
                        <li>Impl√©menter diff√©rents niveaux RAID</li>
                        <li>Combiner LVM et RAID pour une gestion optimale du stockage</li>
                        <li>D√©panner les probl√®mes li√©s au stockage</li>
                    </ul>
                </div>

                <p>La gestion du stockage est un aspect crucial de l'administration syst√®me Linux. Deux technologies majeures permettent d'optimiser cette gestion : <strong>LVM (Logical Volume Manager)</strong> et <strong>RAID (Redundant Array of Independent Disks)</strong>. Ces outils offrent flexibilit√©, performance et redondance pour vos syst√®mes de stockage.</p>
            </div>

            <div class="section" id="lvm">
                <h2>üíæ 2. LVM (Logical Volume Manager)</h2>
                
                <h3>2.1 D√©finition et concepts</h3>
                
                <div class="definition">
                    <strong>LVM (Logical Volume Manager)</strong> est une couche d'abstraction entre les disques physiques et le syst√®me de fichiers. Il permet de cr√©er des volumes logiques flexibles qui peuvent √™tre redimensionn√©s dynamiquement, contrairement aux partitions traditionnelles.
                </div>

                <h4>Architecture LVM :</h4>
                <ul>
                    <li><strong>PV (Physical Volumes)</strong> : Disques ou partitions physiques</li>
                    <li><strong>VG (Volume Groups)</strong> : Groupe de volumes physiques</li>
                    <li><strong>LV (Logical Volumes)</strong> : Volumes logiques cr√©√©s dans un VG</li>
                    <li><strong>PE (Physical Extents)</strong> : Plus petite unit√© d'allocation</li>
                </ul>

                <h3>2.2 Installation et pr√©paration</h3>
                
                <div class="command-box">
<span class="prompt"># </span>Installation des outils LVM
apt update && apt install lvm2

<span class="prompt"># </span>V√©rification des disques disponibles
lsblk
fdisk -l
</div>

                <h3>2.3 Cr√©ation d'une configuration LVM</h3>

                <h4>√âtape 1 : Cr√©er les volumes physiques (PV)</h4>
                <div class="command-box">
<span class="prompt"># </span>Cr√©er un PV sur /dev/sdb
pvcreate /dev/sdb

<span class="prompt"># </span>Cr√©er des PV sur plusieurs disques
pvcreate /dev/sdc /dev/sdd

<span class="prompt"># </span>Afficher les PV
pvdisplay
pvs
</div>

                <h4>√âtape 2 : Cr√©er un groupe de volumes (VG)</h4>
                <div class="command-box">
<span class="prompt"># </span>Cr√©er un VG nomm√© "vg_data"
vgcreate vg_data /dev/sdb /dev/sdc

<span class="prompt"># </span>Afficher les VG
vgdisplay
vgs

<span class="prompt"># </span>√âtendre un VG avec un nouveau PV
vgextend vg_data /dev/sdd
</div>

                <h4>√âtape 3 : Cr√©er des volumes logiques (LV)</h4>
                <div class="command-box">
<span class="prompt"># </span>Cr√©er un LV de 10GB
lvcreate -L 10G -n lv_web vg_data

<span class="prompt"># </span>Cr√©er un LV utilisant 50% de l'espace libre
lvcreate -l 50%FREE -n lv_database vg_data

<span class="prompt"># </span>Afficher les LV
lvdisplay
lvs
</div>

                <h4>√âtape 4 : Formater et monter</h4>
                <div class="command-box">
<span class="prompt"># </span>Formater le volume logique
mkfs.ext4 /dev/vg_data/lv_web

<span class="prompt"># </span>Cr√©er le point de montage
mkdir /var/www

<span class="prompt"># </span>Monter le volume
mount /dev/vg_data/lv_web /var/www

<span class="prompt"># </span>Ajouter au fstab pour montage automatique
echo "/dev/vg_data/lv_web /var/www ext4 defaults 0 2" >> /etc/fstab
</div>

                <h3>2.4 Gestion avanc√©e LVM</h3>

                <h4>Redimensionnement des volumes</h4>
                <div class="command-box">
<span class="prompt"># </span>√âtendre un LV (ajout de 5GB)
lvextend -L +5G /dev/vg_data/lv_web

<span class="prompt"># </span>Redimensionner le syst√®me de fichiers
resize2fs /dev/vg_data/lv_web

<span class="prompt"># </span>R√©duire un LV (attention : d√©monter d'abord)
umount /var/www
e2fsck -f /dev/vg_data/lv_web
resize2fs /dev/vg_data/lv_web 8G
lvreduce -L 8G /dev/vg_data/lv_web
mount /dev/vg_data/lv_web /var/www
</div>

                <h4>Snapshots LVM</h4>
                <div class="command-box">
<span class="prompt"># </span>Cr√©er un snapshot
lvcreate -L 2G -s -n lv_web_snapshot /dev/vg_data/lv_web

<span class="prompt"># </span>Monter le snapshot (lecture seule)
mkdir /mnt/snapshot
mount -o ro /dev/vg_data/lv_web_snapshot /mnt/snapshot

<span class="prompt"># </span>Restaurer depuis un snapshot
umount /var/www
lvconvert --merge /dev/vg_data/lv_web_snapshot
</div>

                <div class="warning">
                    <strong>‚ö†Ô∏è Attention :</strong> La r√©duction de volumes logiques peut entra√Æner une perte de donn√©es. Toujours effectuer une sauvegarde avant de r√©duire un volume.
                </div>
            </div>

            <div class="section" id="raid">
                <h2>üõ°Ô∏è 3. RAID (Redundant Array of Independent Disks)</h2>
                
                <h3>3.1 D√©finition et objectifs</h3>
                
                <div class="definition">
                    <strong>RAID</strong> est une technologie qui combine plusieurs disques physiques en une seule unit√© logique pour am√©liorer les performances, la redondance, ou les deux. Le RAID permet de prot√©ger contre les pannes de disques et d'optimiser les acc√®s.
                </div>

                <h3>3.2 Niveaux RAID principaux</h3>

                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Niveau RAID</th>
                            <th>Nom</th>
                            <th>Minimum disques</th>
                            <th>Redondance</th>
                            <th>Performance</th>
                            <th>Espace utile</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>RAID 0</strong></td>
                            <td>Striping</td>
                            <td>2</td>
                            <td>Aucune</td>
                            <td>Excellente</td>
                            <td>100%</td>
                        </tr>
                        <tr>
                            <td><strong>RAID 1</strong></td>
                            <td>Mirroring</td>
                            <td>2</td>
                            <td>Oui (1 disque)</td>
                            <td>Lecture rapide</td>
                            <td>50%</td>
                        </tr>
                        <tr>
                            <td><strong>RAID 5</strong></td>
                            <td>Parity</td>
                            <td>3</td>
                            <td>Oui (1 disque)</td>
                            <td>Bonne</td>
                            <td>66-90%</td>
                        </tr>
                        <tr>
                            <td><strong>RAID 6</strong></td>
                            <td>Double Parity</td>
                            <td>4</td>
                            <td>Oui (2 disques)</td>
                            <td>Correcte</td>
                            <td>50-88%</td>
                        </tr>
                        <tr>
                            <td><strong>RAID 10</strong></td>
                            <td>Mirror + Stripe</td>
                            <td>4</td>
                            <td>Oui (1 par miroir)</td>
                            <td>Excellente</td>
                            <td>50%</td>
                        </tr>
                    </tbody>
                </table>

                <h3>3.3 Configuration RAID avec mdadm</h3>

                <h4>Installation et pr√©paration</h4>
                <div class="command-box">
<span class="prompt"># </span>Installation de mdadm
apt install mdadm

<span class="prompt"># </span>V√©rification des disques
lsblk
cat /proc/mdstat
</div>

                <h4>Cr√©ation d'un RAID 1</h4>
                <div class="command-box">
<span class="prompt"># </span>Cr√©er un RAID 1 avec /dev/sdb et /dev/sdc
mdadm --create --verbose /dev/md0 --level=1 --raid-devices=2 /dev/sdb /dev/sdc

<span class="prompt"># </span>V√©rifier la progression
cat /proc/mdstat
mdadm --detail /dev/md0

<span class="prompt"># </span>Sauvegarder la configuration
mdadm --detail --scan >> /etc/mdadm/mdadm.conf
update-initramfs -u
</div>

                <h4>Cr√©ation d'un RAID 5</h4>
                <div class="command-box">
<span class="prompt"># </span>Cr√©er un RAID 5 avec 3 disques
mdadm --create --verbose /dev/md1 --level=5 --raid-devices=3 /dev/sdd /dev/sde /dev/sdf

<span class="prompt"># </span>Surveiller la construction
watch cat /proc/mdstat
</div>

                <h4>Gestion des pannes RAID</h4>
                <div class="command-box">
<span class="prompt"># </span>Simuler une panne de disque
mdadm --manage /dev/md0 --fail /dev/sdb

<span class="prompt"># </span>Retirer le disque d√©faillant
mdadm --manage /dev/md0 --remove /dev/sdb

<span class="prompt"># </span>Ajouter un nouveau disque
mdadm --manage /dev/md0 --add /dev/sdg

<span class="prompt"># </span>V√©rifier la reconstruction
mdadm --detail /dev/md0
</div>

                <h3>3.4 Surveillance RAID</h3>
                <div class="command-box">
<span class="prompt"># </span>Configuration de la surveillance automatique
echo "MAILADDR admin@example.com" >> /etc/mdadm/mdadm.conf
systemctl enable mdmonitor
systemctl start mdmonitor

<span class="prompt"># </span>Test d'envoi d'email
mdadm --monitor --test /dev/md0
</div>

                <div class="info">
                    <strong>üí° Conseil :</strong> Configurez toujours la surveillance RAID avec notifications par email pour √™tre alert√© en cas de panne de disque.
                </div>
            </div>

            <div class="section" id="lvm-raid">
                <h2>üîó 4. Combinaison LVM et RAID</h2>
                
                <h3>4.1 Architecture recommand√©e</h3>
                
                <div class="definition">
                    <strong>RAID sous LVM :</strong> Cr√©er d'abord les volumes RAID, puis les utiliser comme volumes physiques LVM. Cette approche offre les avantages du RAID (redondance/performance) et de LVM (flexibilit√©).
                </div>

                <h4>Exemple : RAID 1 + LVM</h4>
                <div class="command-box">
<span class="prompt"># </span>1. Cr√©er un RAID 1
mdadm --create /dev/md0 --level=1 --raid-devices=2 /dev/sdb /dev/sdc

<span class="prompt"># </span>2. Cr√©er un PV sur le RAID
pvcreate /dev/md0

<span class="prompt"># </span>3. Cr√©er un VG
vgcreate vg_raid /dev/md0

<span class="prompt"># </span>4. Cr√©er des LV
lvcreate -L 20G -n lv_system vg_raid
lvcreate -L 30G -n lv_data vg_raid
</div>

                <h4>Exemple : RAID 5 + LVM pour serveur</h4>
                <div class="command-box">
<span class="prompt"># </span>1. Cr√©er un RAID 5 avec 4 disques
mdadm --create /dev/md1 --level=5 --raid-devices=4 /dev/sdd /dev/sde /dev/sdf /dev/sdg

<span class="prompt"># </span>2. Int√©grer dans LVM
pvcreate /dev/md1
vgcreate vg_server /dev/md1

<span class="prompt"># </span>3. Cr√©er les volumes pour diff√©rents services
lvcreate -L 50G -n lv_web vg_server
lvcreate -L 100G -n lv_database vg_server
lvcreate -L 20G -n lv_logs vg_server
</div>

                <h3>4.2 Avantages de la combinaison</h3>
                <ul>
                    <li><strong>Redondance</strong> : Protection contre les pannes mat√©rielles</li>
                    <li><strong>Flexibilit√©</strong> : Redimensionnement dynamique des volumes</li>
                    <li><strong>Performance</strong> : Am√©lioration des acc√®s disque selon le RAID choisi</li>
                    <li><strong>Snapshots</strong> : Sauvegarde coh√©rente des donn√©es</li>
                    <li><strong>Migration</strong> : D√©placement de volumes sans interruption</li>
                </ul>

                <div class="warning">
                    <strong>‚ö†Ô∏è Important :</strong> Toujours sauvegarder la configuration RAID dans /etc/mdadm/mdadm.conf et mettre √† jour l'initramfs apr√®s modifications.
                </div>
            </div>

            <div class="section" id="tp">
                <h2>üß™ 5. Travaux Pratiques</h2>
                
                <h3>TP 1 : Configuration LVM basique</h3>
                
                <div class="info">
                    <strong>Objectif :</strong> Cr√©er une configuration LVM compl√®te avec redimensionnement et snapshot
                </div>

                <h4>√âtapes √† r√©aliser :</h4>
                <ol>
                    <li>Ajouter 3 disques virtuels de 5GB chacun</li>
                    <li>Cr√©er les volumes physiques</li>
                    <li>Cr√©er un groupe de volumes "vg_tp"</li>
                    <li>Cr√©er deux volumes logiques : "lv_web" (8GB) et "lv_db" (6GB)</li>
                    <li>Formater en ext4 et monter</li>
                    <li>Cr√©er du contenu de test</li>
                    <li>Cr√©er un snapshot de lv_web</li>
                    <li>Modifier le contenu original</li>
                    <li>Restaurer depuis le snapshot</li>
                </ol>

                <div class="command-box">
<span class="prompt"># </span>Solution TP 1 :
# 1. Pr√©parer les PV
pvcreate /dev/sdb /dev/sdc /dev/sdd

# 2. Cr√©er le VG
vgcreate vg_tp /dev/sdb /dev/sdc /dev/sdd

# 3. Cr√©er les LV
lvcreate -L 8G -n lv_web vg_tp
lvcreate -L 6G -n lv_db vg_tp

# 4. Formater et monter
mkfs.ext4 /dev/vg_tp/lv_web
mkfs.ext4 /dev/vg_tp/lv_db
mkdir /var/www /var/db
mount /dev/vg_tp/lv_web /var/www
mount /dev/vg_tp/lv_db /var/db

# 5. Cr√©er du contenu
echo "Site web version 1" > /var/www/index.html

# 6. Snapshot
lvcreate -L 1G -s -n lv_web_snap /dev/vg_tp/lv_web

# 7. Modifier
echo "Site web version 2" > /var/www/index.html

# 8. Restaurer
umount /var/www
lvconvert --merge /dev/vg_tp/lv_web_snap
mount /dev/vg_tp/lv_web /var/www
cat /var/www/index.html
</div>

                <h3>TP 2 : Configuration RAID + LVM</h3>
                
                <div class="info">
                    <strong>Objectif :</strong> Impl√©menter une solution RAID 5 avec LVM pour un environnement de production
                </div>

                <h4>Sc√©nario :</h4>
                <p>Vous devez configurer un serveur de fichiers avec 4 disques de 10GB en RAID 5, puis utiliser LVM pour cr√©er des espaces d√©di√©s aux diff√©rents services.</p>

                <div class="command-box">
<span class="prompt"># </span>Solution TP 2 :
# 1. Cr√©er le RAID 5
mdadm --create /dev/md0 --level=5 --raid-devices=4 /dev/sdb /dev/sdc /dev/sdd /dev/sde

# 2. Attendre la synchronisation
watch cat /proc/mdstat

# 3. Configuration LVM sur RAID
pvcreate /dev/md0
vgcreate vg_fileserver /dev/md0

# 4. Cr√©er les volumes m√©tier
lvcreate -L 10G -n lv_documents vg_fileserver
lvcreate -L 15G -n lv_multimedia vg_fileserver
lvcreate -L 5G -n lv_backup vg_fileserver

# 5. Formater et configurer
mkfs.ext4 /dev/vg_fileserver/lv_documents
mkfs.ext4 /dev/vg_fileserver/lv_multimedia
mkfs.ext4 /dev/vg_fileserver/lv_backup

# 6. Monter et configurer fstab
mkdir -p /srv/{documents,multimedia,backup}
mount /dev/vg_fileserver/lv_documents /srv/documents
mount /dev/vg_fileserver/lv_multimedia /srv/multimedia
mount /dev/vg_fileserver/lv_backup /srv/backup

# 7. Sauvegarder la configuration RAID
mdadm --detail --scan >> /etc/mdadm/mdadm.conf
update-initramfs -u
</div>

                <h3>TP 3 : Simulation et r√©cup√©ration de panne</h3>
                
                <div class="warning">
                    <strong>‚ö†Ô∏è Attention :</strong> Ce TP simule des pannes. √Ä effectuer uniquement sur un environnement de test !
                </div>

                <div class="command-box">
<span class="prompt"># </span>Simulation de panne disque
# 1. V√©rifier l'√©tat initial
mdadm --detail /dev/md0

# 2. Simuler une panne
mdadm --manage /dev/md0 --fail /dev/sdb

# 3. Observer l'√©tat d√©grad√©
cat /proc/mdstat
mdadm --detail /dev/md0

# 4. Retirer le disque d√©faillant
mdadm --manage /dev/md0 --remove /dev/sdb

# 5. Ajouter un disque de remplacement
mdadm --manage /dev/md0 --add /dev/sdf

# 6. Surveiller la reconstruction
watch -n 2 'cat /proc/mdstat'

# 7. V√©rifier la r√©paration
mdadm --detail /dev/md0
</div>
            </div>

            <div class="section" id="conclusion">
                <h2>üéì 6. Conclusion et Ressources</h2>
                
                <h3>6.1 Points cl√©s √† retenir</h3>
                
                <div class="info">
                    <strong>LVM :</strong>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>Flexibilit√© de gestion des volumes (redimensionnement)</li>
                        <li>Snapshots pour sauvegardes coh√©rentes</li>
                        <li>Migration de volumes √† chaud</li>
                        <li>Abstraction des limitations physiques</li>
                    </ul>
                </div>

                <div class="info">
                    <strong>RAID :</strong>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>Protection contre les pannes mat√©rielles</li>
                        <li>Am√©lioration des performances selon le niveau</li>
                        <li>Surveillance continue n√©cessaire</li>
                        <li>Choix du niveau selon les besoins (performance vs redondance)</li>
                    </ul>
                </div>

                <h3>6.2 Commandes essentielles</h3>

                <h4>LVM</h4>
                <div class="command-box">
<span class="prompt"># </span>Gestion des Physical Volumes
pvcreate, pvdisplay, pvs, pvremove

<span class="prompt"># </span>Gestion des Volume Groups
vgcreate, vgdisplay, vgs, vgextend, vgreduce

<span class="prompt"># </span>Gestion des Logical Volumes
lvcreate, lvdisplay, lvs, lvextend, lvreduce, lvremove

<span class="prompt"># </span>Snapshots
lvcreate -s, lvconvert --merge

<span class="prompt"># </span>Redimensionnement filesystem
resize2fs (ext2/3/4), xfs_growfs (XFS)
</div>

                <h4>RAID</h4>
                <div class="command-box">
<span class="prompt"># </span>Cr√©ation et gestion
mdadm --create, mdadm --manage, mdadm --detail

<span class="prompt"># </span>Surveillance
cat /proc/mdstat, mdadm --monitor

<span class="prompt"># </span>Configuration
/etc/mdadm/mdadm.conf, update-initramfs -u
</div>

                <h3>6.3 Bonnes pratiques</h3>

                <div class="definition">
                    <strong>Planification :</strong>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>Dimensionner selon les besoins futurs</li>
                        <li>Pr√©voir de l'espace libre pour les snapshots</li>
                        <li>Choisir le niveau RAID adapt√© √† l'usage</li>
                        <li>Designer une strat√©gie de sauvegarde compl√©mentaire</li>
                    </ul>
                </div>

                <div class="definition">
                    <strong>Surveillance :</strong>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>Configurer les alertes RAID par email</li>
                        <li>Surveiller l'espace disque des VG</li>
                        <li>Tester r√©guli√®rement les proc√©dures de r√©cup√©ration</li>
                        <li>Maintenir la documentation √† jour</li>
                    </ul>
                </div>

                <div class="definition">
                    <strong>S√©curit√© :</strong>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>Sauvegarder les configurations LVM et RAID</li>
                        <li>Tester les proc√©dures de restauration</li>
                        <li>Pr√©voir des disques de spare</li>
                        <li>Documenter toutes les modifications</li>
                    </ul>
                </div>

                <h3>6.4 Scripts d'automatisation</h3>

                <h4>Script de surveillance RAID</h4>
                <div class="command-box">
<span class="prompt">#!/bin/bash</span>
# Script de v√©rification RAID quotidien
RAID_STATUS=$(cat /proc/mdstat | grep -c "U_\|_U")
ADMIN_EMAIL="admin@example.com"

if [ $RAID_STATUS -gt 0 ]; then
    echo "ALERTE: RAID d√©grad√© d√©tect√©!" | mail -s "RAID Alert" $ADMIN_EMAIL
    mdadm --detail /dev/md0 | mail -s "RAID Detail" $ADMIN_EMAIL
fi

# V√©rification de l'espace LVM
VG_FREE=$(vgs --noheadings -o vg_free --units g | sed 's/g//' | awk '{print int($1)}')
if [ $VG_FREE -lt 5 ]; then
    echo "ALERTE: Espace LVM faible: ${VG_FREE}GB" | mail -s "LVM Space Alert" $ADMIN_EMAIL
fi
</div>

                <h4>Script de snapshot automatique</h4>
                <div class="command-box">
<span class="prompt">#!/bin/bash</span>
# Script de snapshot LVM automatique
LV_NAME="lv_data"
VG_NAME="vg_server"
SNAPSHOT_SIZE="2G"
DATE=$(date +%Y%m%d_%H%M)

# Cr√©er le snapshot
lvcreate -L $SNAPSHOT_SIZE -s -n ${LV_NAME}_snap_${DATE} /dev/${VG_NAME}/${LV_NAME}

# Nettoyer les anciens snapshots (garde 7 jours)
for snap in $(lvs --noheadings -o lv_name | grep "${LV_NAME}_snap" | head -n -7); do
    lvremove -f /dev/${VG_NAME}/${snap}
done
</div>

                <h3>6.5 D√©pannage courant</h3>

                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Probl√®me</th>
                            <th>Sympt√¥me</th>
                            <th>Solution</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>LV non activ√©</td>
                            <td>Volume inaccessible au boot</td>
                            <td><code>vgchange -ay</code></td>
                        </tr>
                        <tr>
                            <td>RAID d√©grad√©</td>
                            <td>Performance r√©duite</td>
                            <td>Remplacer le disque d√©faillant</td>
                        </tr>
                        <tr>
                            <td>Espace VG plein</td>
                            <td>Impossible d'√©tendre LV</td>
                            <td>Ajouter un PV : <code>vgextend</code></td>
                        </tr>
                        <tr>
                            <td>Snapshot plein</td>
                            <td>Snapshot invalid√©</td>
                            <td>√âtendre ou supprimer le snapshot</td>
                        </tr>
                        <tr>
                            <td>RAID non assembl√©</td>
                            <td>P√©riph√©rique manquant</td>
                            <td><code>mdadm --assemble --scan</code></td>
                        </tr>
                    </tbody>
                </table>

                <h3>6.6 Ressources compl√©mentaires</h3>

                <div class="info">
                    <strong>üìö Documentation officielle :</strong>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>Man pages : <code>man lvm</code>, <code>man mdadm</code></li>
                        <li>Red Hat Storage Administration Guide</li>
                        <li>Ubuntu Server Guide - Storage</li>
                        <li>/usr/share/doc/lvm2/ et /usr/share/doc/mdadm/</li>
                    </ul>
                </div>

                <div class="info">
                    <strong>üîß Outils de monitoring :</strong>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li><strong>Nagios</strong> : Surveillance RAID et LVM</li>
                        <li><strong>Zabbix</strong> : Monitoring avanc√© du stockage</li>
                        <li><strong>Prometheus + Grafana</strong> : M√©triques temps r√©el</li>
                        <li><strong>SMART tools</strong> : Surveillance proactive des disques</li>
                    </ul>
                </div>

                <h3>6.7 Certification et √©valuation</h3>

                <div class="definition">
                    <strong>Comp√©tences acquises :</strong>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>‚úÖ Cr√©ation et gestion de volumes LVM</li>
                        <li>‚úÖ Configuration de diff√©rents niveaux RAID</li>
                        <li>‚úÖ Combinaison optimale LVM + RAID</li>
                        <li>‚úÖ Proc√©dures de r√©cup√©ration en cas de panne</li>
                        <li>‚úÖ Automatisation et surveillance</li>
                    </ul>
                </div>

                <div class="warning">
                    <strong>‚ö†Ô∏è Rappel important :</strong> RAID n'est PAS une sauvegarde ! Il prot√®ge contre les pannes mat√©rielles mais pas contre les erreurs humaines, corruptions logicielles, ou d√©sastres. Impl√©mentez toujours une strat√©gie de sauvegarde compl√©mentaire.
                </div>

                <h3>6.8 Exercices pratiques suppl√©mentaires</h3>

                <div class="info">
                    <strong>üí™ D√©fis avanc√©s :</strong>
                    <ol style="margin-top: 10px; padding-left: 20px;">
                        <li>Migrer un syst√®me de partitions classiques vers LVM</li>
                        <li>Convertir un RAID 5 en RAID 6 sans perte de donn√©es</li>
                        <li>Cr√©er un script de sauvegarde utilisant les snapshots LVM</li>
                        <li>Impl√©menter un syst√®me de cache SSD avec dm-cache</li>
                        <li>Configurer la d√©duplication avec VDO</li>
                    </ol>
                </div>

                <div class="nav-buttons">
                    <a href="#" class="btn">‚Üê Jour 21 - Gestion de disques</a>
                    <a href="#" class="btn">Jour 23 - Sauvegarde et restauration ‚Üí</a>
                </div>
            </div>
        </div>

        <div class="content">
            <div class="section">
                <h2>üìù R√©sum√© du cours</h2>
                <p>Ce cours vous a pr√©sent√© les technologies essentielles LVM et RAID pour la gestion avanc√©e du stockage sous Linux. Vous ma√Ætrisez maintenant la cr√©ation de volumes flexibles avec LVM, l'impl√©mentation de diff√©rents niveaux RAID pour la redondance et les performances, ainsi que leur combinaison optimale pour des environnements de production robustes.</p>
                
                <p><strong>La ma√Ætrise de ces outils est fondamentale pour tout administrateur syst√®me Linux</strong>, car ils constituent la base d'une infrastructure de stockage fiable et √©volutive.</p>
                
                <div class="definition">
                    <strong>üéØ Prochaines √©tapes :</strong><br>
                    Dans le prochain cours (Jour 23), nous aborderons les strat√©gies de sauvegarde et de restauration, compl√©ment indispensable aux technologies RAID pour une protection compl√®te de vos donn√©es.
                </div>
            </div>
        </div>
    </div>
</body>
</html>