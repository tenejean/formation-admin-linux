<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jour 24 - Virtualisation sous Linux</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header .subtitle {
            color: #7f8c8d;
            font-size: 1.2em;
            font-weight: 300;
        }

        .content-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .content-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        .section-title {
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
            position: relative;
        }

        .section-title::before {
            content: '';
            position: absolute;
            left: 0;
            bottom: -3px;
            width: 50px;
            height: 3px;
            background: #764ba2;
        }

        .subsection {
            margin-bottom: 25px;
        }

        .subsection h3 {
            color: #34495e;
            font-size: 1.3em;
            margin-bottom: 15px;
            padding: 10px 0;
            border-left: 4px solid #667eea;
            padding-left: 15px;
        }

        .definition-box {
            background: linear-gradient(135deg, #667eea20, #764ba220);
            border-left: 5px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }

        .definition-box strong {
            color: #2c3e50;
            font-size: 1.1em;
        }

        .command-box {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
            position: relative;
        }

        .command-box::before {
            content: '$ ';
            color: #27ae60;
            font-weight: bold;
        }

        .advantages, .disadvantages {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .advantage-item, .disadvantage-item {
            padding: 15px;
            border-radius: 10px;
            transition: transform 0.2s ease;
        }

        .advantage-item {
            background: linear-gradient(135deg, #27ae6020, #2ecc7120);
            border-left: 4px solid #27ae60;
        }

        .disadvantage-item {
            background: linear-gradient(135deg, #e74c3c20, #c0392b20);
            border-left: 4px solid #e74c3c;
        }

        .advantage-item:hover, .disadvantage-item:hover {
            transform: translateX(5px);
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .comparison-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ecf0f1;
        }

        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .comparison-table tr:hover {
            background: #e3f2fd;
        }

        .practical-section {
            background: linear-gradient(135deg, #ffecd2, #fcb69f);
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
        }

        .step {
            background: white;
            margin: 15px 0;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #ff6b6b;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .step h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .warning {
            background: linear-gradient(135deg, #ff9a56, #ff6b6b);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #d63031;
        }

        .info {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #2d3436;
        }

        ul, ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
        }

        .highlight {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
        }

        .architecture-diagram {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .content-card {
                padding: 20px;
            }
            
            .advantages, .disadvantages {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Formation Admin Système Linux</h1>
            <div class="subtitle">Jour 24 - Virtualisation sous Linux</div>
            <p style="margin-top: 10px; color: #666;">Responsable: Jean Tene</p>
        </div>

        <div class="content-card">
            <h2 class="section-title">1. Introduction à la Virtualisation</h2>
            
            <div class="definition-box">
                <strong>Définition:</strong> La virtualisation est une technologie qui permet de créer des versions virtuelles de ressources informatiques physiques, notamment des serveurs, des systèmes d'exploitation, des périphériques de stockage et des ressources réseau.
            </div>

            <div class="subsection">
                <h3>Objectifs de ce cours</h3>
                <ul>
                    <li>Comprendre les concepts fondamentaux de la virtualisation</li>
                    <li>Découvrir les différents types de virtualisation</li>
                    <li>Apprendre à utiliser les principaux hyperviseurs sous Linux</li>
                    <li>Maîtriser la gestion des machines virtuelles</li>
                    <li>Comprendre les enjeux de performance et de sécurité</li>
                </ul>
            </div>
        </div>

        <div class="content-card">
            <h2 class="section-title">2. Concepts Fondamentaux</h2>
            
            <div class="subsection">
                <h3>Terminologie Essentielle</h3>
                
                <div class="definition-box">
                    <strong>Hyperviseur (Hypervisor):</strong> Logiciel qui permet de créer et gérer des machines virtuelles en partageant les ressources matérielles d'un serveur physique.
                </div>

                <div class="definition-box">
                    <strong>Machine Virtuelle (VM):</strong> Environnement informatique virtualisé qui fonctionne comme un ordinateur physique avec son propre système d'exploitation.
                </div>

                <div class="definition-box">
                    <strong>Hôte (Host):</strong> Le système physique sur lequel l'hyperviseur est installé et où s'exécutent les machines virtuelles.
                </div>

                <div class="definition-box">
                    <strong>Invité (Guest):</strong> Le système d'exploitation qui s'exécute à l'intérieur d'une machine virtuelle.
                </div>
            </div>

            <div class="architecture-diagram">
                <h4>Architecture de Virtualisation</h4>
                <div style="font-family: monospace; font-size: 14px; line-height: 2;">
                    ┌─────────────────────────────────────────────┐<br>
                    │           Applications Invitées            │<br>
                    ├─────────────────────────────────────────────┤<br>
                    │      Systèmes d'Exploitation Invités       │<br>
                    ├─────────────────────────────────────────────┤<br>
                    │              Hyperviseur                    │<br>
                    ├─────────────────────────────────────────────┤<br>
                    │        Système d'Exploitation Hôte         │<br>
                    ├─────────────────────────────────────────────┤<br>
                    │            Matériel Physique                │<br>
                    └─────────────────────────────────────────────┘
                </div>
            </div>
        </div>

        <div class="content-card">
            <h2 class="section-title">3. Types de Virtualisation</h2>
            
            <div class="subsection">
                <h3>Virtualisation Complète (Full Virtualization)</h3>
                <p>L'hyperviseur émule complètement le matériel, permettant aux systèmes d'exploitation invités de fonctionner sans modification.</p>
                
                <div class="advantages">
                    <div class="advantage-item">
                        <strong>Avantages:</strong>
                        <ul>
                            <li>Isolation complète entre les VMs</li>
                            <li>Support de tous les OS</li>
                            <li>Sécurité renforcée</li>
                        </ul>
                    </div>
                </div>

                <div class="disadvantages">
                    <div class="disadvantage-item">
                        <strong>Inconvénients:</strong>
                        <ul>
                            <li>Surcharge performance importante</li>
                            <li>Consommation mémoire élevée</li>
                            <li>Complexité de gestion</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="subsection">
                <h3>Para-virtualisation</h3>
                <p>Les systèmes d'exploitation invités sont modifiés pour communiquer directement avec l'hyperviseur.</p>
                
                <div class="advantages">
                    <div class="advantage-item">
                        <strong>Avantages:</strong>
                        <ul>
                            <li>Meilleures performances</li>
                            <li>Moins de surcharge</li>
                            <li>Efficacité énergétique</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="subsection">
                <h3>Virtualisation par Conteneurs</h3>
                <p>Partage du noyau du système hôte entre plusieurs espaces utilisateur isolés.</p>
                
                <div class="info">
                    <strong>Note:</strong> Les conteneurs seront traités en détail dans les cours suivants (Jour 25 et 26).
                </div>
            </div>
        </div>

        <div class="content-card">
            <h2 class="section-title">4. Types d'Hyperviseurs</h2>
            
            <div class="subsection">
                <h3>Hyperviseur de Type 1 (Bare Metal)</h3>
                <p>S'exécute directement sur le matériel physique sans système d'exploitation hôte.</p>
                
                <div class="definition-box">
                    <strong>Exemples:</strong> VMware vSphere/ESXi, Microsoft Hyper-V, Citrix XenServer, KVM (avec certaines configurations)
                </div>

                <div class="advantages">
                    <div class="advantage-item">
                        <strong>Avantages:</strong>
                        <ul>
                            <li>Performances optimales</li>
                            <li>Stabilité et sécurité élevées</li>
                            <li>Idéal pour les environnements de production</li>
                            <li>Gestion centralisée efficace</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="subsection">
                <h3>Hyperviseur de Type 2 (Hosted)</h3>
                <p>S'exécute comme une application sur un système d'exploitation hôte existant.</p>
                
                <div class="definition-box">
                    <strong>Exemples:</strong> VirtualBox, VMware Workstation, VMware Fusion, QEMU, Parallels Desktop
                </div>

                <div class="advantages">
                    <div class="advantage-item">
                        <strong>Avantages:</strong>
                        <ul>
                            <li>Installation simple</li>
                            <li>Idéal pour le développement et les tests</li>
                            <li>Interface utilisateur conviviale</li>
                            <li>Coût d'entrée faible</li>
                        </ul>
                    </div>
                </div>
            </div>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Critère</th>
                        <th>Type 1 (Bare Metal)</th>
                        <th>Type 2 (Hosted)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Performance</strong></td>
                        <td>Excellente</td>
                        <td>Bonne avec surcharge</td>
                    </tr>
                    <tr>
                        <td><strong>Sécurité</strong></td>
                        <td>Très élevée</td>
                        <td>Dépend de l'OS hôte</td>
                    </tr>
                    <tr>
                        <td><strong>Complexité</strong></td>
                        <td>Élevée</td>
                        <td>Faible à moyenne</td>
                    </tr>
                    <tr>
                        <td><strong>Coût</strong></td>
                        <td>Élevé</td>
                        <td>Faible à moyen</td>
                    </tr>
                    <tr>
                        <td><strong>Usage typique</strong></td>
                        <td>Production, datacenter</td>
                        <td>Développement, tests</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="content-card">
            <h2 class="section-title">5. KVM (Kernel-based Virtual Machine)</h2>
            
            <div class="definition-box">
                <strong>KVM</strong> est une solution de virtualisation complète pour Linux intégrée au noyau Linux depuis la version 2.6.20. KVM transforme Linux en hyperviseur de type 1.
            </div>

            <div class="subsection">
                <h3>Architecture KVM</h3>
                <p>KVM utilise les extensions de virtualisation matérielle (Intel VT-x ou AMD-V) pour offrir des performances optimales.</p>
                
                <div class="info">
                    <strong>Composants principaux:</strong>
                    <ul>
                        <li><span class="highlight">Module noyau KVM</span> - Gestion de la virtualisation</li>
                        <li><span class="highlight">QEMU</span> - Émulation matérielle et gestion des E/S</li>
                        <li><span class="highlight">libvirt</span> - API de gestion des machines virtuelles</li>
                        <li><span class="highlight">virt-manager</span> - Interface graphique de gestion</li>
                    </ul>
                </div>
            </div>

            <div class="practical-section">
                <h3>Installation de KVM</h3>
                
                <div class="step">
                    <h4>Étape 1: Vérification du support matériel</h4>
                    <div class="command-box">egrep -c '(vmx|svm)' /proc/cpuinfo</div>
                    <p>Si le résultat est supérieur à 0, votre processeur supporte la virtualisation.</p>
                </div>

                <div class="step">
                    <h4>Étape 2: Vérification des extensions KVM</h4>
                    <div class="command-box">lsmod | grep kvm</div>
                    <div class="command-box">ls -la /dev/kvm</div>
                </div>

                <div class="step">
                    <h4>Étape 3: Installation des paquets (Ubuntu/Debian)</h4>
                    <div class="command-box">sudo apt update</div>
                    <div class="command-box">sudo apt install qemu-kvm libvirt-daemon-system libvirt-clients bridge-utils virt-manager</div>
                </div>

                <div class="step">
                    <h4>Étape 4: Installation des paquets (CentOS/RHEL)</h4>
                    <div class="command-box">sudo yum install qemu-kvm libvirt libvirt-python libguestfs-tools virt-install virt-viewer</div>
                </div>

                <div class="step">
                    <h4>Étape 5: Activation et démarrage des services</h4>
                    <div class="command-box">sudo systemctl enable libvirtd</div>
                    <div class="command-box">sudo systemctl start libvirtd</div>
                    <div class="command-box">sudo systemctl status libvirtd</div>
                </div>

                <div class="step">
                    <h4>Étape 6: Ajout de l'utilisateur au groupe libvirt</h4>
                    <div class="command-box">sudo usermod -aG libvirt $USER</div>
                    <div class="command-box">sudo usermod -aG kvm $USER</div>
                    <p><em>Redémarrez votre session après cette étape.</em></p>
                </div>
            </div>
        </div>

        <div class="content-card">
            <h2 class="section-title">6. Gestion des Machines Virtuelles avec KVM</h2>
            
            <div class="subsection">
                <h3>Création d'une Machine Virtuelle</h3>
                
                <div class="step">
                    <h4>Méthode 1: Avec virt-install (ligne de commande)</h4>
                    <div class="command-box">virt-install \<br>
  --name ubuntu-vm \<br>
  --ram 2048 \<br>
  --disk path=/var/lib/libvirt/images/ubuntu-vm.img,size=20 \<br>
  --vcpus 2 \<br>
  --os-type linux \<br>
  --os-variant ubuntu20.04 \<br>
  --network bridge=virbr0 \<br>
  --graphics vnc,listen=0.0.0.0 \<br>
  --console pty,target_type=serial \<br>
  --cdrom /path/to/ubuntu.iso</div>
                </div>

                <div class="step">
                    <h4>Méthode 2: Avec virt-manager (interface graphique)</h4>
                    <ol>
                        <li>Lancer virt-manager : <code>virt-manager</code></li>
                        <li>Cliquer sur "Créer une nouvelle machine virtuelle"</li>
                        <li>Suivre l'assistant de création</li>
                        <li>Configurer les ressources (CPU, RAM, stockage)</li>
                        <li>Sélectionner l'ISO d'installation</li>
                    </ol>
                </div>
            </div>

            <div class="subsection">
                <h3>Commandes de Gestion avec virsh</h3>
                
                <div class="step">
                    <h4>Commandes de Base</h4>
                    <div class="command-box">virsh list --all</div>
                    <p>Lister toutes les machines virtuelles</p>
                    
                    <div class="command-box">virsh start nom-vm</div>
                    <p>Démarrer une machine virtuelle</p>
                    
                    <div class="command-box">virsh shutdown nom-vm</div>
                    <p>Arrêter proprement une machine virtuelle</p>
                    
                    <div class="command-box">virsh destroy nom-vm</div>
                    <p>Forcer l'arrêt d'une machine virtuelle</p>
                    
                    <div class="command-box">virsh suspend nom-vm</div>
                    <p>Suspendre une machine virtuelle</p>
                    
                    <div class="command-box">virsh resume nom-vm</div>
                    <p>Reprendre une machine virtuelle suspendue</p>
                </div>

                <div class="step">
                    <h4>Gestion des Snapshots</h4>
                    <div class="command-box">virsh snapshot-create-as nom-vm snapshot1 "Description du snapshot"</div>
                    <p>Créer un snapshot</p>
                    
                    <div class="command-box">virsh snapshot-list nom-vm</div>
                    <p>Lister les snapshots</p>
                    
                    <div class="command-box">virsh snapshot-revert nom-vm snapshot1</div>
                    <p>Restaurer un snapshot</p>
                    
                    <div class="command-box">virsh snapshot-delete nom-vm snapshot1</div>
                    <p>Supprimer un snapshot</p>
                </div>

                <div class="step">
                    <h4>Clonage de Machines Virtuelles</h4>
                    <div class="command-box">virt-clone --original nom-vm-source --name nom-vm-clone --file /var/lib/libvirt/images/clone.img</div>
                    <p>Cloner une machine virtuelle</p>
                </div>
            </div>
        </div>

        <div class="content-card">
            <h2 class="section-title">7. VirtualBox</h2>
            
            <div class="definition-box">
                <strong>VirtualBox</strong> est un hyperviseur de type 2 développé par Oracle, gratuit et multiplateforme, idéal pour le développement et les tests.
            </div>

            <div class="practical-section">
                <h3>Installation de VirtualBox</h3>
                
                <div class="step">
                    <h4>Ubuntu/Debian</h4>
                    <div class="command-box">sudo apt update</div>
                    <div class="command-box">sudo apt install virtualbox virtualbox-ext-pack</div>
                </div>

                <div class="step">
                    <h4>CentOS/RHEL</h4>
                    <div class="command-box">sudo yum install epel-release</div>
                    <div class="command-box">sudo yum install VirtualBox-6.1</div>
                </div>

                <div class="step">
                    <h4>Gestion en ligne de commande avec VBoxManage</h4>
                    <div class="command-box">VBoxManage list vms</div>
                    <p>Lister les machines virtuelles</p>
                    
                    <div class="command-box">VBoxManage startvm "nom-vm" --type headless</div>
                    <p>Démarrer une VM en mode headless</p>
                    
                    <div class="command-box">VBoxManage controlvm "nom-vm" poweroff</div>
                    <p>Arrêter une machine virtuelle</p>
                </div>
            </div>
        </div>

        <div class="content-card">
            <h2 class="section-title">8. Gestion du Réseau Virtuel</h2>
            
            <div class="subsection">
                <h3>Types de Configuration Réseau</h3>
                
                <div class="step">
                    <h4>NAT (Network Address Translation)</h4>
                    <p>La VM partage l'adresse IP de l'hôte via NAT.</p>
                    <div class="advantages">
                        <div class="advantage-item">
                            <strong>Avantages:</strong> Simple, accès Internet automatique
                        </div>
                    </div>
                    <div class="disadvantages">
                        <div class="disadvantage-item">
                            <strong>Inconvénients:</strong> VM non accessible depuis l'extérieur
                        </div>
                    </div>
                </div>

                <div class="step">
                    <h4>Bridge (Pont)</h4>
                    <p>La VM obtient sa propre adresse IP sur le réseau physique.</p>
                    <div class="advantages">
                        <div class="advantage-item">
                            <strong>Avantages:</strong> VM accessible depuis le réseau, comme une machine physique
                        </div>
                    </div>
                </div>

                <div class="step">
                    <h4>Host-Only</h4>
                    <p>Communication uniquement entre l'hôte et les VMs.</p>
                    <div class="advantages">
                        <div class="advantage-item">
                            <strong>Avantages:</strong> Sécurisé, idéal pour les tests isolés
                        </div>
                    </div>
                </div>
            </div>

            <div class="practical-section">
                <h3>Configuration d'un Bridge sous Linux</h3>
                
                <div class="step">
                    <h4>Création d'un bridge avec netplan (Ubuntu)</h4>
                    <div class="command-box">sudo nano /etc/netplan/01-netcfg.yaml</div>
                    <pre style="background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 8px; margin: 10px 0;">
network:
  version: 2
  ethernets:
    enp0s3:
      dhcp4: false
  bridges:
    br0:
      interfaces: [enp0s3]
      dhcp4: true
                    </pre>
                    <div class="command-box">sudo netplan apply</div>
                </div>
            </div>
        </div>

        <div class="content-card">
            <h2 class="section-title">9. Optimisation et Performance</h2>
            
            <div class="subsection">
                <h3>Allocation des Ressources</h3>
                
                <div class="warning">
                    <strong>Attention:</strong> Ne jamais allouer plus de 75% des ressources physiques aux machines virtuelles pour maintenir les performances du système hôte.
                </div>

                <div class="step">
                    <h4>Bonnes Pratiques CPU</h4>
                    <ul>
                        <li>Allouer 1 vCPU par VM pour commencer</li>
                        <li>Éviter l'over-provisioning excessif</li>
                        <li>Utiliser la topologie CPU appropriée</li>
                        <li>Activer les fonctionnalités de virtualisation matérielle</li>
                    </ul>
                </div>

                <div class="step">
                    <h4>Optimisation Mémoire</h4>
                    <ul>
                        <li>Utiliser la mémoire ballooning</li>
                        <li>Configurer le swap approprié</li>
                        <li>Monitorer l'utilisation mémoire</li>
                        <li>Éviter le memory over-commitment critique</li>
                    </ul>
                </div>

                <div class="step">
                    <h4>Configuration des disques virtuels</h4>
                    <div class="command-box">qemu-img create -f qcow2 -o preallocation=metadata disk.qcow2 20G</div>
                    <p>Créer un disque avec pré-allocation pour de meilleures performances</p>
                    
                    <div class="command-box">qemu-img convert -f raw -O qcow2 disk.img disk.qcow2</div>
                    <p>Convertir un disque RAW en QCOW2</p>
                </div>
            </div>

            <div class="subsection">
                <h3>Outils de Monitoring</h3>
                
                <div class="step">
                    <h4>Surveillance avec virsh</h4>
                    <div class="command-box">virsh domstats nom-vm</div>
                    <p>Statistiques détaillées d'une VM</p>
                    
                    <div class="command-box">virsh domifstat nom-vm vnet0</div>
                    <p>Statistiques réseau d'une interface</p>
                    
                    <div class="command-box">virsh domblkstat nom-vm vda</div>
                    <p>Statistiques disque</p>
                </div>

                <div class="step">
                    <h4>Outils système</h4>
                    <div class="command-box">htop</div>
                    <p>Monitoring CPU et mémoire en temps réel</p>
                    
                    <div class="command-box">iotop</div>
                    <p>Monitoring des E/S disque</p>
                    
                    <div class="command-box">nethogs</div>
                    <p>Monitoring de l'utilisation réseau par processus</p>
                </div>
            </div>
        </div>

        <div class="content-card">
            <h2 class="section-title">10. Sécurité en Virtualisation</h2>
            
            <div class="subsection">
                <h3>Isolation et Sécurité</h3>
                
                <div class="step">
                    <h4>Principes de Sécurité</h4>
                    <ul>
                        <li><strong>Isolation des VMs:</strong> Chaque VM doit être isolée des autres</li>
                        <li><strong>Sécurisation de l'hyperviseur:</strong> Mise à jour régulière et configuration sécurisée</li>
                        <li><strong>Gestion des accès:</strong> Contrôle strict des permissions</li>
                        <li><strong>Chiffrement:</strong> Chiffrement des disques virtuels et des communications</li>
                    </ul>
                </div>

                <div class="step">
                    <h4>Configuration SELinux pour KVM</h4>
                    <div class="command-box">setsebool -P virt_use_nfs 1</div>
                    <p>Autoriser KVM à utiliser NFS</p>
                    
                    <div class="command-box">getsebool -a | grep virt</div>
                    <p>Voir tous les booléens SELinux liés à la virtualisation</p>
                </div>

                <div class="step">
                    <h4>Chiffrement des disques virtuels</h4>
                    <div class="command-box">qemu-img create -f qcow2 --object secret,id=sec0,data=password \
-o encrypt.format=luks,encrypt.key-secret=sec0 encrypted-disk.qcow2 10G</div>
                    <p>Créer un disque virtuel chiffré avec LUKS</p>
                </div>
            </div>

            <div class="subsection">
                <h3>Sauvegarde et Récupération</h3>
                
                <div class="step">
                    <h4>Sauvegarde des VMs</h4>
                    <div class="command-box">virsh dumpxml nom-vm > nom-vm.xml</div>
                    <p>Sauvegarder la configuration XML</p>
                    
                    <div class="command-box">cp /var/lib/libvirt/images/nom-vm.qcow2 /backup/</div>
                    <p>Sauvegarder le disque virtuel (VM arrêtée)</p>
                    
                    <div class="command-box">virsh save nom-vm /backup/nom-vm.save</div>
                    <p>Sauvegarder l'état complet de la VM</p>
                </div>

                <div class="step">
                    <h4>Restauration des VMs</h4>
                    <div class="command-box">virsh define nom-vm.xml</div>
                    <p>Restaurer la configuration depuis XML</p>
                    
                    <div class="command-box">virsh restore /backup/nom-vm.save</div>
                    <p>Restaurer l'état complet de la VM</p>
                </div>
            </div>
        </div>

        <div class="content-card">
            <h2 class="section-title">11. Cas d'Usage et Scénarios Pratiques</h2>
            
            <div class="subsection">
                <h3>Environnement de Développement</h3>
                <div class="step">
                    <h4>Configuration type</h4>
                    <ul>
                        <li>VMs pour différents OS (Ubuntu, CentOS, Windows)</li>
                        <li>Isolation des environnements de test</li>
                        <li>Snapshots pour revenir rapidement à un état stable</li>
                        <li>Réseau host-only pour la sécurité</li>
                    </ul>
                </div>
            </div>

            <div class="subsection">
                <h3>Infrastructure de Production</h3>
                <div class="step">
                    <h4>Architecture recommandée</h4>
                    <ul>
                        <li>Hyperviseur de type 1 (KVM bare metal)</li>
                        <li>Haute disponibilité avec clustering</li>
                        <li>Stockage partagé (SAN/NAS)</li>
                        <li>Monitoring et alertes automatisées</li>
                        <li>Sauvegardes automatisées</li>
                    </ul>
                </div>
            </div>

            <div class="practical-section">
                <h3>TP Pratique: Création d'un Environnement Multi-VM</h3>
                
                <div class="step">
                    <h4>Objectif</h4>
                    <p>Créer un environnement avec 3 VMs : 1 serveur web, 1 base de données, 1 load balancer</p>
                </div>

                <div class="step">
                    <h4>Étape 1: Création du réseau virtuel</h4>
                    <div class="command-box">virsh net-define /etc/libvirt/qemu/networks/lab-network.xml</div>
                    <div class="command-box">virsh net-start lab-network</div>
                    <div class="command-box">virsh net-autostart lab-network</div>
                </div>

                <div class="step">
                    <h4>Étape 2: Création des VMs</h4>
                    <div class="command-box">for vm in web-server db-server load-balancer; do
  virt-install \
    --name $vm \
    --ram 1024 \
    --disk path=/var/lib/libvirt/images/$vm.qcow2,size=10 \
    --vcpus 1 \
    --os-type linux \
    --os-variant ubuntu20.04 \
    --network network=lab-network \
    --graphics none \
    --console pty,target_type=serial \
    --location 'http://archive.ubuntu.com/ubuntu/dists/focal/main/installer-amd64/' \
    --extra-args 'console=ttyS0,115200n8 serial'
done</div>
                </div>

                <div class="step">
                    <h4>Étape 3: Configuration post-installation</h4>
                    <ol>
                        <li>Configurer les adresses IP statiques</li>
                        <li>Installer les services requis (Apache, MySQL, HAProxy)</li>
                        <li>Configurer la communication entre les VMs</li>
                        <li>Tester la connectivité</li>
                    </ol>
                </div>
            </div>
        </div>

        <div class="content-card">
            <h2 class="section-title">12. Dépannage et Résolution de Problèmes</h2>
            
            <div class="subsection">
                <h3>Problèmes Courants</h3>
                
                <div class="step">
                    <h4>VM ne démarre pas</h4>
                    <div class="command-box">virsh start nom-vm --console</div>
                    <p>Démarrer avec sortie console pour voir les erreurs</p>
                    
                    <div class="command-box">tail -f /var/log/libvirt/qemu/nom-vm.log</div>
                    <p>Consulter les logs QEMU</p>
                </div>

                <div class="step">
                    <h4>Problèmes de performance</h4>
                    <div class="command-box">virsh dominfo nom-vm</div>
                    <p>Vérifier l'allocation des ressources</p>
                    
                    <div class="command-box">virsh vcpuinfo nom-vm</div>
                    <p>Informations détaillées sur les vCPUs</p>
                </div>

                <div class="step">
                    <h4>Problèmes réseau</h4>
                    <div class="command-box">virsh domiflist nom-vm</div>
                    <p>Lister les interfaces réseau de la VM</p>
                    
                    <div class="command-box">brctl show</div>
                    <p>Afficher l'état des bridges réseau</p>
                </div>
            </div>

            <div class="subsection">
                <h3>Outils de Diagnostic</h3>
                
                <div class="step">
                    <h4>Vérification de l'état du système</h4>
                    <div class="command-box">virt-host-validate</div>
                    <p>Valider la configuration de l'hôte de virtualisation</p>
                    
                    <div class="command-box">virsh capabilities</div>
                    <p>Afficher les capacités de l'hyperviseur</p>
                    
                    <div class="command-box">virsh nodeinfo</div>
                    <p>Informations sur le nœud hôte</p>
                </div>
            </div>
        </div>

        <div class="content-card">
            <h2 class="section-title">13. Évolutions et Tendances</h2>
            
            <div class="subsection">
                <h3>Virtualisation vs Conteneurisation</h3>
                
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Aspect</th>
                            <th>Machines Virtuelles</th>
                            <th>Conteneurs</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Isolation</strong></td>
                            <td>Complète (OS séparé)</td>
                            <td>Processus (OS partagé)</td>
                        </tr>
                        <tr>
                            <td><strong>Ressources</strong></td>
                            <td>Plus importantes</td>
                            <td>Légères</td>
                        </tr>
                        <tr>
                            <td><strong>Démarrage</strong></td>
                            <td>Minutes</td>
                            <td>Secondes</td>
                        </tr>
                        <tr>
                            <td><strong>Portabilité</strong></td>
                            <td>Limitée</td>
                            <td>Excellente</td>
                        </tr>
                        <tr>
                            <td><strong>Sécurité</strong></td>
                            <td>Très élevée</td>
                            <td>Bonne avec précautions</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="subsection">
                <h3>Technologies Émergentes</h3>
                <ul>
                    <li><strong>Virtualisation nested:</strong> VMs dans des VMs</li>
                    <li><strong>GPU passthrough:</strong> Accès direct au GPU depuis les VMs</li>
                    <li><strong>SR-IOV:</strong> Virtualisation réseau au niveau matériel</li>
                    <li><strong>VFIO:</strong> Framework d'E/S virtualisées</li>
                    <li><strong>Cloud-init:</strong> Automatisation de la configuration initiale</li>
                </ul>
            </div>
        </div>

        <div class="content-card">
            <h2 class="section-title">14. Exercices Pratiques</h2>
            
            <div class="practical-section">
                <div class="step">
                    <h4>Exercice 1: Installation et Configuration KVM</h4>
                    <ol>
                        <li>Installer KVM et les outils associés</li>
                        <li>Vérifier la configuration</li>
                        <li>Créer une première VM Ubuntu</li>
                        <li>Configurer l'accès réseau</li>
                    </ol>
                </div>

                <div class="step">
                    <h4>Exercice 2: Gestion Avancée</h4>
                    <ol>
                        <li>Créer un snapshot de la VM</li>
                        <li>Modifier la configuration (RAM, CPU)</li>
                        <li>Cloner la VM</li>
                        <li>Configurer un réseau bridge</li>
                    </ol>
                </div>

                <div class="step">
                    <h4>Exercice 3: Automatisation</h4>
                    <ol>
                        <li>Créer un script de déploiement automatique</li>
                        <li>Utiliser cloud-init pour la configuration</li>
                        <li>Mettre en place une sauvegarde automatisée</li>
                        <li>Configurer le monitoring des VMs</li>
                    </ol>
                </div>
            </div>
        </div>

        <div class="content-card">
            <h2 class="section-title">15. Ressources et Documentation</h2>
            
            <div class="subsection">
                <h3>Documentation Officielle</h3>
                <ul>
                    <li><strong>KVM:</strong> kernel.org/doc/Documentation/virtual/kvm/</li>
                    <li><strong>libvirt:</strong> libvirt.org/docs.html</li>
                    <li><strong>QEMU:</strong> qemu.org/documentation/</li>
                    <li><strong>VirtualBox:</strong> virtualbox.org/manual/</li>
                </ul>
            </div>

            <div class="subsection">
                <h3>Commandes de Référence Rapide</h3>
                <div class="command-box"># Gestion des VMs
virsh list --all                 # Lister toutes les VMs
virsh start/shutdown/destroy VM  # Contrôler les VMs
virsh console VM                 # Accéder à la console
virsh edit VM                    # Éditer la configuration

# Gestion des snapshots
virsh snapshot-create-as VM nom  # Créer un snapshot
virsh snapshot-list VM           # Lister les snapshots
virsh snapshot-revert VM nom     # Restaurer un snapshot

# Gestion du réseau
virsh net-list --all            # Lister les réseaux
virsh net-start/stop réseau     # Contrôler les réseaux

# Monitoring
virsh domstats VM               # Statistiques détaillées
virsh domifstat VM interface    # Stats réseau
virsh domblkstat VM disque      # Stats disque</div>
            </div>

            <div class="info">
                <strong>Prochaine étape:</strong> Le prochain cours (Jour 25) portera sur les conteneurs et Docker, une technologie complémentaire à la virtualisation traditionnelle.
            </div>
        </div>

        <div class="content-card" style="text-align: center; background: linear-gradient(135deg, #667eea, #764ba2); color: white;">
            <h2 style="color: white; border-bottom: 3px solid white;">Résumé du Jour 24</h2>
            <div style="margin-top: 20px;">
                <p>✅ <strong>Concepts de virtualisation maîtrisés</strong></p>
                <p>✅ <strong>Installation et configuration KVM</strong></p>
                <p>✅ <strong>Gestion des machines virtuelles</strong></p>
                <p>✅ <strong>Configuration réseau virtuel</strong></p>
                <p>✅ <strong>Optimisation et sécurité</strong></p>
                <p>✅ <strong>Dépannage et monitoring</strong></p>
            </div>
            <div style="margin-top: 30px; font-size: 1.1em;">
                <p><strong>Prochaine session :</strong> Jour 25 - Conteneurs et Docker</p>
            </div>
        </div>
    </div>
</body>
</html>