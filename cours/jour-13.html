<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jour 13 - Boucles et fonctions</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header .subtitle {
            color: #7f8c8d;
            font-size: 1.2em;
            font-weight: 300;
        }

        .content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .section {
            margin-bottom: 40px;
        }

        .section h2 {
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #3498db;
            position: relative;
        }

        .section h2::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 50px;
            height: 3px;
            background: #e74c3c;
        }

        .section h3 {
            color: #34495e;
            font-size: 1.4em;
            margin: 25px 0 15px 0;
            padding-left: 15px;
            border-left: 4px solid #3498db;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.3);
            border: 1px solid #34495e;
        }

        .code-block pre {
            margin: 0;
            white-space: pre-wrap;
        }

        .highlight {
            background: linear-gradient(120deg, #a8edea 0%, #fed6e3 100%);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 5px solid #3498db;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .warning {
            background: linear-gradient(120deg, #ffeaa7 0%, #fab1a0 100%);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 5px solid #e17055;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .success {
            background: linear-gradient(120deg, #a8e6cf 0%, #88d8a3 100%);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 5px solid #00b894;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .exercise {
            background: linear-gradient(120deg, #ffd3a5 0%, #fd9853 100%);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid #fd9853;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .exercise h4 {
            color: #d63031;
            font-size: 1.3em;
            margin-bottom: 10px;
        }

        .objectives {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .objective-card {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            transform: translateY(0);
            transition: all 0.3s ease;
        }

        .objective-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .syntax-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .syntax-table th,
        .syntax-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .syntax-table th {
            background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
            color: white;
            font-weight: bold;
        }

        .syntax-table tr:hover {
            background: rgba(116, 185, 255, 0.1);
        }

        ul, ol {
            padding-left: 30px;
            margin: 15px 0;
        }

        li {
            margin: 8px 0;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .content {
                padding: 20px;
            }
            
            .objectives {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîÑ Jour 13 - Boucles et fonctions</h1>
            <p class="subtitle">Formation Administration Syst√®me Linux - Responsable: Jean Tene</p>
        </div>

        <div class="content">
            <div class="section">
                <h2>üìã Objectifs du cours</h2>
                <div class="objectives">
                    <div class="objective-card">
                        <h4>üîÑ Ma√Ætriser les boucles</h4>
                        <p>Comprendre et utiliser les diff√©rents types de boucles en shell scripting</p>
                    </div>
                    <div class="objective-card">
                        <h4>‚öôÔ∏è Cr√©er des fonctions</h4>
                        <p>D√©velopper des fonctions r√©utilisables pour optimiser vos scripts</p>
                    </div>
                    <div class="objective-card">
                        <h4>üõ†Ô∏è Applications pratiques</h4>
                        <p>Impl√©menter des solutions automatis√©es avec boucles et fonctions</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üîÑ Les boucles en shell</h2>
                
                <h3>1. Boucle FOR</h3>
                <p>La boucle <code>for</code> est utilis√©e pour it√©rer sur une liste d'√©l√©ments ou une s√©quence.</p>
                
                <div class="highlight">
                    <strong>Syntaxe de base :</strong>
                    <div class="code-block">
<pre>for variable in liste
do
    commandes
done</pre>
                    </div>
                </div>

                <h4>Exemples pratiques :</h4>
                
                <div class="code-block">
<pre># It√©rer sur une liste de mots
for fruit in pomme poire banane
do
    echo "Fruit: $fruit"
done

# It√©rer sur les fichiers d'un r√©pertoire
for fichier in /home/user/*.txt
do
    echo "Traitement de: $fichier"
done

# Boucle avec s√©quence num√©rique
for i in {1..10}
do
    echo "Nombre: $i"
done

# Boucle C-style
for ((i=1; i<=10; i++))
do
    echo "Compteur: $i"
done</pre>
                </div>

                <h3>2. Boucle WHILE</h3>
                <p>La boucle <code>while</code> continue tant qu'une condition est vraie.</p>
                
                <div class="highlight">
                    <strong>Syntaxe :</strong>
                    <div class="code-block">
<pre>while [ condition ]
do
    commandes
done</pre>
                    </div>
                </div>

                <div class="code-block">
<pre># Exemple de boucle while
compteur=1
while [ $compteur -le 5 ]
do
    echo "It√©ration: $compteur"
    compteur=$((compteur + 1))
done

# Lecture d'un fichier ligne par ligne
while IFS= read -r ligne
do
    echo "Ligne lue: $ligne"
done < fichier.txt

# Boucle infinie (√† utiliser avec pr√©caution)
while true
do
    echo "Tapez 'quit' pour sortir:"
    read input
    if [ "$input" = "quit" ]; then
        break
    fi
done</pre>
                </div>

                <h3>3. Boucle UNTIL</h3>
                <p>La boucle <code>until</code> continue tant qu'une condition est fausse.</p>
                
                <div class="code-block">
<pre># Syntaxe until
until [ condition ]
do
    commandes
done

# Exemple pratique
compteur=1
until [ $compteur -gt 5 ]
do
    echo "Compteur: $compteur"
    compteur=$((compteur + 1))
done</pre>
                </div>

                <h3>4. Contr√¥le de boucles</h3>
                
                <table class="syntax-table">
                    <tr>
                        <th>Commande</th>
                        <th>Description</th>
                        <th>Utilisation</th>
                    </tr>
                    <tr>
                        <td><code>break</code></td>
                        <td>Sort compl√®tement de la boucle</td>
                        <td>Arr√™t conditionnel</td>
                    </tr>
                    <tr>
                        <td><code>continue</code></td>
                        <td>Passe √† l'it√©ration suivante</td>
                        <td>Ignorer certaines valeurs</td>
                    </tr>
                </table>

                <div class="code-block">
<pre># Exemple avec break et continue
for i in {1..10}
do
    if [ $i -eq 3 ]; then
        continue  # Ignore 3
    fi
    if [ $i -eq 8 ]; then
        break     # Sort √† 8
    fi
    echo "Nombre: $i"
done</pre>
                </div>
            </div>

            <div class="section">
                <h2>‚öôÔ∏è Les fonctions en shell</h2>
                
                <h3>1. D√©finition et syntaxe</h3>
                <p>Les fonctions permettent de cr√©er des blocs de code r√©utilisables et modulaires.</p>
                
                <div class="highlight">
                    <strong>Syntaxes possibles :</strong>
                    <div class="code-block">
<pre># Syntaxe 1
function nom_fonction {
    commandes
}

# Syntaxe 2 (recommand√©e)
nom_fonction() {
    commandes
}</pre>
                    </div>
                </div>

                <h3>2. Exemples de fonctions</h3>
                
                <div class="code-block">
<pre># Fonction simple
saluer() {
    echo "Bonjour, bienvenue!"
}

# Appel de la fonction
saluer

# Fonction avec param√®tres
saluer_personne() {
    local nom=$1
    local age=$2
    echo "Bonjour $nom, vous avez $age ans"
}

# Utilisation
saluer_personne "Alice" 25

# Fonction avec valeur de retour
addition() {
    local a=$1
    local b=$2
    local resultat=$((a + b))
    echo $resultat
}

# Capture du r√©sultat
somme=$(addition 10 20)
echo "La somme est: $somme"</pre>
                </div>

                <h3>3. Variables locales et globales</h3>
                
                <div class="warning">
                    <strong>‚ö†Ô∏è Important :</strong> Utilisez toujours <code>local</code> pour les variables dans les fonctions pour √©viter les conflits.
                </div>

                <div class="code-block">
<pre># Variables locales vs globales
variable_globale="Global"

ma_fonction() {
    local variable_locale="Local"
    variable_globale="Modifi√©e"
    echo "Dans la fonction: $variable_locale"
    echo "Variable globale: $variable_globale"
}

echo "Avant: $variable_globale"
ma_fonction
echo "Apr√®s: $variable_globale"</pre>
                </div>

                <h3>4. Param√®tres de fonction</h3>
                
                <table class="syntax-table">
                    <tr>
                        <th>Variable</th>
                        <th>Description</th>
                        <th>Exemple</th>
                    </tr>
                    <tr>
                        <td><code>$1, $2, ...</code></td>
                        <td>Param√®tres positionnels</td>
                        <td>Premier, deuxi√®me param√®tre</td>
                    </tr>
                    <tr>
                        <td><code>$#</code></td>
                        <td>Nombre de param√®tres</td>
                        <td>V√©rifier les arguments</td>
                    </tr>
                    <tr>
                        <td><code>$@</code></td>
                        <td>Tous les param√®tres</td>
                        <td>Traiter tous les arguments</td>
                    </tr>
                    <tr>
                        <td><code>$*</code></td>
                        <td>Tous les param√®tres (cha√Æne)</td>
                        <td>Concat√©nation</td>
                    </tr>
                </table>

                <div class="code-block">
<pre># Fonction avec gestion des param√®tres
calculer() {
    if [ $# -lt 2 ]; then
        echo "Usage: calculer nombre1 nombre2"
        return 1
    fi
    
    local num1=$1
    local num2=$2
    local operation=${3:-"+"}  # Op√©ration par d√©faut: addition
    
    case $operation in
        "+") echo $((num1 + num2)) ;;
        "-") echo $((num1 - num2)) ;;
        "*") echo $((num1 * num2)) ;;
        "/") 
            if [ $num2 -eq 0 ]; then
                echo "Erreur: Division par z√©ro"
                return 1
            fi
            echo $((num1 / num2)) 
            ;;
        *) echo "Op√©ration non support√©e: $operation" ;;
    esac
}

# Utilisation
calculer 10 5
calculer 10 5 "*"
calculer 10 0 "/"</pre>
                </div>

                <h3>5. Codes de retour</h3>
                
                <div class="code-block">
<pre># Fonction avec code de retour
verifier_fichier() {
    local fichier=$1
    
    if [ -z "$fichier" ]; then
        echo "Nom de fichier requis"
        return 1
    fi
    
    if [ -f "$fichier" ]; then
        echo "Le fichier $fichier existe"
        return 0
    else
        echo "Le fichier $fichier n'existe pas"
        return 2
    fi
}

# Utilisation avec test du code de retour
verifier_fichier "/etc/passwd"
case $? in
    0) echo "Fichier trouv√©!" ;;
    1) echo "Param√®tre manquant" ;;
    2) echo "Fichier non trouv√©" ;;
esac</pre>
                </div>
            </div>

            <div class="section">
                <h2>üõ†Ô∏è Applications pratiques</h2>
                
                <h3>1. Script de sauvegarde avec boucles</h3>
                
                <div class="code-block">
<pre>#!/bin/bash

# Script de sauvegarde multiple
sauvegarder_repertoires() {
    local repertoires=("/home/user/documents" "/home/user/images" "/etc")
    local destination="/backup"
    local date_sauvegarde=$(date +%Y%m%d_%H%M%S)
    
    for repertoire in "${repertoires[@]}"
    do
        if [ -d "$repertoire" ]; then
            echo "Sauvegarde de $repertoire..."
            nom_sauvegarde=$(basename "$repertoire")_$date_sauvegarde.tar.gz
            tar -czf "$destination/$nom_sauvegarde" "$repertoire"
            echo "Sauvegarde termin√©e: $nom_sauvegarde"
        else
            echo "R√©pertoire non trouv√©: $repertoire"
        fi
    done
}

sauvegarder_repertoires</pre>
                </div>

                <h3>2. Fonction de monitoring syst√®me</h3>
                
                <div class="code-block">
<pre>#!/bin/bash

# Fonction de monitoring
monitorer_systeme() {
    local seuil_cpu=${1:-80}
    local seuil_disque=${2:-90}
    
    echo "=== Monitoring Syst√®me ==="
    echo "Seuils: CPU ${seuil_cpu}%, Disque ${seuil_disque}%"
    echo
    
    # V√©rification CPU
    cpu_usage=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)
    if (( $(echo "$cpu_usage > $seuil_cpu" | bc -l) )); then
        echo "‚ö†Ô∏è  CPU √©lev√©: ${cpu_usage}%"
    else
        echo "‚úÖ CPU normal: ${cpu_usage}%"
    fi
    
    # V√©rification disque
    while read ligne
    do
        usage=$(echo $ligne | awk '{print $5}' | cut -d'%' -f1)
        partition=$(echo $ligne | awk '{print $6}')
        
        if [ "$usage" -gt "$seuil_disque" ]; then
            echo "‚ö†Ô∏è  Disque plein: $partition (${usage}%)"
        else
            echo "‚úÖ Disque OK: $partition (${usage}%)"
        fi
    done < <(df -h | grep -E '^/dev/')
}

monitorer_systeme 75 85</pre>
                </div>

                <h3>3. Menu interactif avec fonctions</h3>
                
                <div class="code-block">
<pre>#!/bin/bash

# Fonctions du menu
afficher_menu() {
    echo "=== Menu Principal ==="
    echo "1. Afficher les processus"
    echo "2. Afficher l'espace disque"
    echo "3. Afficher les utilisateurs connect√©s"
    echo "4. Quitter"
    echo -n "Votre choix: "
}

afficher_processus() {
    echo "=== Processus actifs ==="
    ps aux | head -10
}

afficher_disque() {
    echo "=== Espace disque ==="
    df -h
}

afficher_utilisateurs() {
    echo "=== Utilisateurs connect√©s ==="
    who
}

# Menu principal
while true
do
    afficher_menu
    read choix
    
    case $choix in
        1) afficher_processus ;;
        2) afficher_disque ;;
        3) afficher_utilisateurs ;;
        4) echo "Au revoir!"; break ;;
        *) echo "Choix invalide!" ;;
    esac
    
    echo
    echo "Appuyez sur Entr√©e pour continuer..."
    read
    clear
done</pre>
                </div>
            </div>

            <div class="section">
                <h2>üìù Exercices pratiques</h2>
                
                <div class="exercise">
                    <h4>Exercice 1: Calculatrice avec boucle</h4>
                    <p>Cr√©ez un script qui :</p>
                    <ul>
                        <li>Demande continuellement des op√©rations √† l'utilisateur</li>
                        <li>Utilise des fonctions pour chaque op√©ration (+, -, *, /)</li>
                        <li>Permet de quitter avec "quit"</li>
                        <li>G√®re les erreurs (division par z√©ro, saisie invalide)</li>
                    </ul>
                </div>

                <div class="exercise">
                    <h4>Exercice 2: Gestionnaire de fichiers</h4>
                    <p>D√©veloppez un script avec les fonctions suivantes :</p>
                    <ul>
                        <li><code>lister_fichiers()</code> - Affiche les fichiers d'un r√©pertoire</li>
                        <li><code>compter_fichiers()</code> - Compte les fichiers par extension</li>
                        <li><code>nettoyer_temp()</code> - Supprime les fichiers temporaires</li>
                        <li>Menu interactif pour utiliser ces fonctions</li>
                    </ul>
                </div>

                <div class="exercise">
                    <h4>Exercice 3: Analyse de logs</h4>
                    <p>Cr√©ez un script qui :</p>
                    <ul>
                        <li>Lit un fichier de log ligne par ligne</li>
                        <li>Compte les occurrences d'erreurs par fonction</li>
                        <li>Identifie les adresses IP les plus fr√©quentes</li>
                        <li>G√©n√®re un rapport de synth√®se</li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2>üí° Bonnes pratiques</h2>
                
                <div class="success">
                    <h4>‚úÖ Recommandations :</h4>
                    <ul>
                        <li><strong>Variables locales :</strong> Utilisez toujours <code>local</code> dans les fonctions</li>
                        <li><strong>Validation :</strong> V√©rifiez les param√®tres avant traitement</li>
                        <li><strong>Codes de retour :</strong> Utilisez des codes de retour explicites</li>
                        <li><strong>Documentation :</strong> Commentez vos fonctions complexes</li>
                        <li><strong>R√©utilisabilit√© :</strong> Cr√©ez des fonctions modulaires</li>
                        <li><strong>Gestion d'erreurs :</strong> Pr√©voyez les cas d'erreur</li>
                    </ul>
                </div>

                <div class="warning">
                    <h4>‚ö†Ô∏è √Ä √©viter :</h4>
                    <ul>
                        <li>Boucles infinies sans condition de sortie</li>
                        <li>Fonctions trop longues et complexes</li>
                        <li>Variables globales dans les fonctions</li>
                        <li>Absence de validation des param√®tres</li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2>üìö Ressources suppl√©mentaires</h2>
                
                <h3>Commandes utiles pour le d√©bogage :</h3>
                <div class="code-block">
<pre># D√©bogage de script
bash -x script.sh

# Afficher les variables dans une fonction
set -x  # Activer le d√©bogage
set +x  # D√©sactiver le d√©bogage

# V√©rifier la syntaxe
bash -n script.sh</pre>
                </div>

                <h3>Exemples avanc√©s :</h3>
                <div class="code-block">
<pre># Fonction r√©cursive (factorielle)
factorielle() {
    local n=$1
    if [ $n -le 1 ]; then
        echo 1
    else
        local prev=$(factorielle $((n-1)))
        echo $((n * prev))
    fi
}

# Fonction avec tableau
traiter_tableau() {
    local -n tableau_ref=$1  # R√©f√©rence au tableau
    
    for element in "${tableau_ref[@]}"
    do
        echo "Traitement: $element"
    done
}

# Utilisation
mon_tableau=("apple" "banana" "cherry")
traiter_tableau mon_tableau</pre>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>üìñ Formation Administration Syst√®me Linux - Jour 13<br>
            üë®‚Äçüíª Responsable: Jean Tene | üéØ Boucles et fonctions</p>
        </div>
    </div>
</body>
</html>